---
title: GAMES104-Lecture 06 游戏中地形大气和云的渲染P2
date: 2024-01-07 16:48:00 +0800
categories: [Computer Graphics, GAMES104]
tags: [图形学, 学习笔记]

pin: false
author: 
    name: CALL1CE
    link: https://space.bilibili.com/9330604
toc: true
comments: true
math: true
mermaid: true

---

## Atmosphere

### Analytic Atmosphere Appearance Modeling

* 公式有两个参数：向上看的方向与天顶的夹角θ，向上看的方向与太阳的夹角γ

* 优点：计算简单高效

* 缺点：局限于地面视角，不能模拟从空中看、参数不能自由修改

### Participating Media

* 气体分子、气溶胶

* 光线与Participating Media的交互
  
  * Absorption 吸收
  
  * Out-scattering 散射
  
  * Emission 发光
  
  * In-scattering 附近的Participating Media的Out-scattering对打到自己

* Radiative Transfer Equation(RTE)

* Volume Rendering Equation(VRE)

* Real Physics in Atmosphere
  
  * Sun Light(不同波长)
  
  * Air Molecules气体分子：N2、O2
  
  * Aerosols气溶胶分子：Dust、Sand

### Scattering Types

* Rayleigh Scattering
  
  * 对于越短的波长（蓝光、紫光）散射得越厉害，长波长（红光）散射很少
  
  * λ是波长，θ是光线和介质的夹角，h是海拔高度（用来表示空气密度）

* Mie Scattering
  
  * 有方向性，沿着光的方向会略强，不考虑波长的影响
  
  * 比上面的方程多一个g，等于0就和上面的方程一样，大于0会有不同的效果
  
  * mie散射一般表现雾和光晕

* Single Scattering & Multi Scattering

### Variant Air Molecules Absorption

* Ozone(O3)：吸收长波长的光

* Methane(CH4)：吸收红光

### Ray Marching

* 沿着视线，把沿途的效果一步一步地积分起来

* 计算复杂，那么就空间换时间，预先计算，存在表中

**Precomputed Atmospheric Scattering：**

* 大气模拟主要看两个参数：transmittance通透度、scattering散射
  
  * 存 在地球上的任意一个点，视线与天顶的夹角
  * 存 现在所在的海拔高度
  * 然后transmittance LUT存的就是从这么一个点看向这个θ方向，直到大气层的边界处，这些大气的通透度
  * scattering散射要用三个角度算

* Challenges：
  
  * multi-scattering很贵
  
  * 手机端不好生成transmittance LUT
  
  * 不好生成动态的切换效果

**Production Friendly Quick Sky and Atmosphere Rendering：**

* 能表达动态的效果

## Cloud

### Cloud Type

### Mesh Based Cloud Modeling

* 高质量

* 整体计算昂贵、不支持动态天气

### Billboard Cloud

* 直接上贴图，高效

* 效果不太好

### Volumetric Cloud Modeling

* 优点：全动态、形状多变、可以飘

* 缺点：效率低，运算昂贵

* Weather Texture：随机的云的分布+云的厚度

* Noise Functions
  
  * Perlin Noise：用一个多项式的时间
  
  * Worley Noise

* Cloud Desity Model


